<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Dev Radar</title>

		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width">
		<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2361701055964881" crossorigin="anonymous"></script>
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	</head>
	<body>
		<header>
			<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
				<div class="container">
					<a class="navbar-brand" href="/">
						<img src="/logo.png" width="30" height="30" class="d-inline-block align-top" alt="logo"> Dev Radar</a>
					<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>
					<div class="collapse navbar-collapse" id="navbarSupportedContent">
						<ul class="navbar-nav me-auto mb-2 mb-lg-0">
							<li class="nav-item">
								<a class="nav-link active" aria-current="page" href="/">Home</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" aria-current="page" href="/topics">Topics</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" aria-current="page" href="/archives/1">Archives</a>
							</li>
						</ul>
					</div>
				</div>
			</nav>
		</header>
		<main class="container">

			<ins class="adsbygoogle mb-2" data-ad-client="ca-pub-2361701055964881" data-ad-slot="9315501947" data-ad-format="auto" data-full-width-responsive="true"></ins>

			<article class="card mt-2">
	<div class="card-header">
		<h1 class="mb-0">Understanding Object Allocation in C#: Heap and Stack</h1>
		<div>
			<small>2023/06/06</small>
		</div>

	</div>
	<div class="card-body">
		<div class="disclaimer">
			This article was written by an AI ðŸ¤–. The original article can be found <a href="https://gevorgchobanyan.medium.com/where-are-objects-allocated-in-c-understanding-heap-and-stack-951febcac8fe?source=friends_link&amp;sk=c7b5377291d59ffb2846c0bfebf997ba" target="_blank"> here</a>.<br/>
			If you want to learn more about how this works, check out <a href="https://github.com/lfarroco/news-radar" target="_blank">this repo</a>.
		</div>
		<p>As a C# developer, understanding where objects are allocated is crucial for optimizing memory usage and ensuring efficient code execution. In this article, we will delve into the two primary memory locations for object allocation in C#: the heap and the stack. By grasping these concepts, youâ€™ll be equipped with valuable insights that can help you write high-performance C# applications.</p>
<p>Heap vs. Stack: Unveiling the Allocation Paradigm</p>
<p>In C#, objects can be stored either on the heap or the stack, and comprehending the differences between these two memory locations is essential. The stack is used for storing value types and reference types that are declared as local variables or method parameters. When a method is called, a new stack frame is created to store the method's local variables and parameters. When the method returns, the stack frame is popped, and the memory is automatically deallocated.</p>
<p>On the other hand, the heap is used for storing reference types that are created using the &quot;new&quot; keyword, and it's the responsibility of the garbage collector to free up the memory when it's no longer needed. The heap is a larger memory space than the stack, and it's not organized in a specific order like the stack.</p>
<p>Allocating Objects: Reference Types and Value Types</p>
<p>Now that we understand the basics of heap and stack memory, letâ€™s explore how different types of objects are allocated in C#. Value types are allocated on the stack, and they are passed by value. Reference types, on the other hand, are allocated on the heap, and they are passed by reference.</p>
<p>Starting with C# 7.2, you can declare a struct as a ref struct, ensuring it is always allocated on the stack and preventing it from being declared inside reference types. This can be useful for performance-critical scenarios where you want to avoid heap allocations.</p>
<p>Reference Semantics for Value Types</p>
<p>While value types are typically passed by copy, C# provides mechanisms to allow accessing value types by reference, thus introducing reference semantics. The &quot;ref&quot; and &quot;out&quot; keywords can be used to pass value types by reference. The &quot;in&quot; keyword can be used to pass value types by reference without allowing them to be modified.</p>
<p>Memory Management: Garbage Collection and the Heap</p>
<p>One of the critical aspects of managing memory in C# is understanding how the heap memory is freed up. When an object on the heap no longer has any references pointing to it, it becomes eligible for garbage collection. At a certain point, the garbage collector kicks in, interrupts running threads, invokes the finalizers of the objects it needs to collect (on a special finalizer thread), and then marks the memory as available for reuse.</p>
<p>The Large Object Heap (LOH): A Special Memory Space</p>
<p>In C#, the heap is further divided into the Small Object Heap (SOH) and the Large Object Heap (LOH). This separation is primarily to address memory fragmentation and optimize memory usage. The SOH is used for objects smaller than 85,000 bytes, while the LOH is used for larger objects.</p>
<p>Understanding the Small Object Heap (SOH) and the Large Object Heap (LOH) is vital for memory optimization in your C# applications, as it allows you to make informed decisions regarding object size and memory allocation.</p>
<p>In conclusion, understanding object allocation in C# is crucial for writing high-performance applications. By grasping the differences between the heap and the stack, you can optimize memory usage and ensure efficient code execution. Knowing how value types and reference types are allocated, and how memory is managed through garbage collection, can help you write more efficient and effective code.</p>
	</div>
</article>

		</main>
		<footer class="footer mt-auto py-3 bg-dark">
			<div class="container">
				<div class="row">
					<div class="col-sm-2">
						<span class="text-muted">2023 | dev-radar</span>
					</div>
					<div class="col-sm-2">
						<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 496 512">
							<!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
							<style>
								svg {
									fill: #ffffff;
								}
							</style><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
						<a class="text-muted" href="https://github.com/lfarroco/news-radar"> GitHub </a>

					</div>
				</div>
			</footer>
			<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
			<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
			<link rel="stylesheet" href="/styles.css"/>
			<script>
				(adsbygoogle = window.adsbygoogle || []).push({});
			</script>
		</body>

	</html>